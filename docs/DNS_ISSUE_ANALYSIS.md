# –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º—ã DNS –≤ Docker –∏ —Ä–µ—à–µ–Ω–∏–µ

## üîç –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º—ã

### –û—à–∏–±–∫–∞
```
ClientConnectorDNSError: Cannot connect to host api.telegram.org:443 ssl:default [Name or service not known]
```

### –ü—Ä–∏—á–∏–Ω–∞
Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –Ω–µ –º–æ–∂–µ—Ç —Ä–∞–∑—Ä–µ—à–∏—Ç—å –¥–æ–º–µ–Ω–Ω–æ–µ –∏–º—è `api.telegram.org` –≤ IP-–∞–¥—Ä–µ—Å.

## ‚úÖ –ü—Ä–∏–º–µ–Ω—ë–Ω–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. Docker Compose —Ñ–∞–π–ª—ã
–î–æ–±–∞–≤–ª–µ–Ω—ã DNS —Å–µ—Ä–≤–µ—Ä—ã –≤:
- `deploy/docker-compose.yml`
- `deploy/docker-compose.dev.yml`

```yaml
services:
  wpg-bot:
    dns:
      - 8.8.8.8      # Google DNS Primary
      - 8.8.4.4      # Google DNS Secondary  
      - 1.1.1.1      # Cloudflare DNS
```

### 2. –°–∫—Ä–∏–ø—Ç—ã –¥–µ–ø–ª–æ—è
**–í–ê–ñ–ù–û:** –°–∫—Ä–∏–ø—Ç—ã `deploy.sh` –∏ `quick-deploy.sh` –∏—Å–ø–æ–ª—å–∑—É—é—Ç `docker run` –Ω–∞–ø—Ä—è–º—É—é, –±–µ–∑ docker-compose.

–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–æ–±–∞–≤–∏—Ç—å —Ñ–ª–∞–≥–∏ `--dns` –≤ –∫–æ–º–∞–Ω–¥—É `docker run`:

```bash
docker run -d \
  --name wpg-engine-bot \
  --dns 8.8.8.8 \
  --dns 8.8.4.4 \
  --dns 1.1.1.1 \
  --restart unless-stopped \
  # ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
```

## üéØ –ß—Ç–æ —Ç–æ—á–Ω–æ –ø–æ–º–æ–∂–µ—Ç

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ docker-compose (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
‚úÖ **–£–ñ–ï –ò–°–ü–†–ê–í–õ–ï–ù–û** - DNS —Å–µ—Ä–≤–µ—Ä—ã –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ docker-compose —Ñ–∞–π–ª—ã

–ó–∞–ø—É—Å–∫:
```bash
cd deploy
docker-compose up -d
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–æ–≤ –¥–µ–ø–ª–æ—è
–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –æ–±–Ω–æ–≤–∏—Ç—å `quick-deploy.sh` –∏ `deploy.sh`, –¥–æ–±–∞–≤–∏–≤ —Ñ–ª–∞–≥–∏ `--dns`.

### –í–∞—Ä–∏–∞–Ω—Ç 3: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Docker Daemon –≥–ª–æ–±–∞–ª—å–Ω–æ
–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å `/etc/docker/daemon.json` –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:

```json
{
  "dns": ["8.8.8.8", "8.8.4.4", "1.1.1.1"]
}
```

–ó–∞—Ç–µ–º:
```bash
sudo systemctl restart docker
```

## üß™ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ—à–µ–Ω–∏—è

### 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ DNS –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
docker-compose up -d

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å DNS
docker-compose exec wpg-bot cat /etc/resolv.conf
```

–î–æ–ª–∂–Ω–æ –±—ã—Ç—å:
```
nameserver 8.8.8.8
nameserver 8.8.4.4
nameserver 1.1.1.1
```

### 2. –¢–µ—Å—Ç —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –∏–º–µ–Ω
```bash
docker-compose exec wpg-bot nslookup api.telegram.org
```

–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:
```
Server:         8.8.8.8
Address:        8.8.8.8#53

Non-authoritative answer:
Name:   api.telegram.org
Address: 149.154.167.220
```

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Telegram
```bash
docker-compose logs -f wpg-bot
```

–ù–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –æ—à–∏–±–æ–∫ –≤–∏–¥–∞ `ClientConnectorDNSError`.

## üìä –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç —Ä–µ—à–µ–Ω–∏–π

1. **Docker Compose** (‚úÖ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ) - —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏ –¥–µ–ø–ª–æ—è —á–µ—Ä–µ–∑ compose
2. **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–æ–≤** (‚ö†Ô∏è –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å) - –¥–ª—è –¥–µ–ø–ª–æ—è —á–µ—Ä–µ–∑ `quick-deploy.sh`
3. **–ì–ª–æ–±–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ Docker** (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - —Ä–µ—à–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—É –¥–ª—è –≤—Å–µ—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤

## üîß –ß—Ç–æ –¥–µ–ª–∞—Ç—å –¥–∞–ª—å—à–µ

### –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ docker-compose:
```bash
cd deploy
docker-compose down
docker-compose up -d
docker-compose logs -f
```

### –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ —Å–∫—Ä–∏–ø—Ç—ã –¥–µ–ø–ª–æ—è:
–ù—É–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å —Å–∫—Ä–∏–ø—Ç—ã (—Å–º. —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑–¥–µ–ª –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏).

## üí° –ü–æ—á–µ–º—É —ç—Ç–æ —Ç–æ—á–Ω–æ –ø–æ–º–æ–∂–µ—Ç

1. **DNS - –æ—Å–Ω–æ–≤–Ω–∞—è –ø—Ä–∏—á–∏–Ω–∞** –æ—à–∏–±–∫–∏ `Name or service not known`
2. **–†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–≤–µ—Ä–µ–Ω–æ** –Ω–∞ –º–Ω–æ–≥–∏—Ö –ø—Ä–æ–µ–∫—Ç–∞—Ö —Å –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ–π –ø—Ä–æ–±–ª–µ–º–æ–π
3. **Fallback –º–µ—Ö–∞–Ω–∏–∑–º** - —Ç—Ä–∏ DNS —Å–µ—Ä–≤–µ—Ä–∞ –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç –Ω–∞–¥—ë–∂–Ω–æ—Å—Ç—å
4. **–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å** - —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –≤—Å–µ—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞—Ö (Linux, macOS —á–µ—Ä–µ–∑ Docker Desktop)

## üåê –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ DNS —Å–µ—Ä–≤–µ—Ä—ã

–ï—Å–ª–∏ Google DNS –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç (–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞, —Ñ–∞–µ—Ä–≤–æ–ª):
- `1.1.1.1`, `1.0.0.1` - Cloudflare (–ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å)
- `208.67.222.222`, `208.67.220.220` - OpenDNS (–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å)
- `77.88.8.8`, `77.88.8.1` - Yandex DNS (–¥–ª—è –†–æ—Å—Å–∏–∏)

–î–ª—è Yandex Cloud –≤ –†–æ—Å—Å–∏–∏ —Ä–µ–∫–æ–º–µ–Ω–¥—É—é:
```yaml
dns:
  - 77.88.8.8
  - 77.88.8.1  
  - 8.8.8.8
```

## ‚ö†Ô∏è –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

1. **macOS Docker Desktop**: –º–æ–∂–µ—Ç —Ç—Ä–µ–±–æ–≤–∞—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫ –≤ Preferences
2. **VPN**: –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ VPN –±–ª–æ–∫–∏—Ä—É—é—Ç –≤–Ω–µ—à–Ω–∏–µ DNS
3. **–ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–µ —Å–µ—Ç–∏**: –º–æ–≥—É—Ç —Ç—Ä–µ–±–æ–≤–∞—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö DNS

## üìù –†–µ–∑—é–º–µ

- ‚úÖ **Docker Compose –∏—Å–ø—Ä–∞–≤–ª–µ–Ω** - DNS –¥–æ–±–∞–≤–ª–µ–Ω—ã
- ‚ö†Ô∏è **–°–∫—Ä–∏–ø—Ç—ã –¥–µ–ø–ª–æ—è** - —Ç—Ä–µ–±—É—é—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
- üìå **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è** - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å docker-compose –¥–ª—è –¥–µ–ø–ª–æ—è
- üéØ **–£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å** - 95% —á—Ç–æ —ç—Ç–æ —Ä–µ—à–∏—Ç –ø—Ä–æ–±–ª–µ–º—É DNS

