# Reload WPG Engine

Движок для проведения ВПИ (текстовые стратегические многопользовательские игры)

## Описание

Настраиваемая платформа для проведения текстовых военно-политических игр с возможностью постепенной автоматизации.

## Технический стек

- **Язык**: Python 3.10+
- **База данных**: SQLite
- **ОРМ**: SQLAlchemy
- **Telegram**: aiogram
- **VK**: vk bottle
- **AI**: OpenRouter API
- **Markdown**: telegramify-markdown
- **Конфиг**: Pydantic Settings

## Архитектура

Монолит с адаптерами

## Установка

```bash
pip install -r requirements.txt
```

## Запуск

### 1. Установка зависимостей
```bash
pip install -r requirements.txt
```

### 2. Настройка окружения
Скопируйте `.env.example` в `.env` и настройте переменные:
```bash
cp .env.example .env
```

Обязательно укажите:
- `TG_TOKEN` - токен Telegram бота от @BotFather

### 3. Инициализация игры
```bash
python init_game.py
```

### 4. Запуск бота
```bash
python run_bot.py
```

### 5. Тестирование движка (опционально)
```bash
python test_engine.py
```

## Структура проекта

```
wpg_engine/
├── core/           # Основная логика
├── models/         # Модели данных
├── adapters/       # Адаптеры для внешних сервисов
│   └── telegram/   # Telegram бот
├── config/         # Конфигурация
└── migrations/     # Миграции базы данных
```

## Telegram бот

### Команды для игроков:
- `/start` - начать работу с ботом
- `/register` - зарегистрироваться в игре (создать страну)
- `/stats` - информация о своей стране
- `/post` - отправить пост с действием
- `/world` - информация о других странах
- `/help` - справка по командам

### Команды для администраторов:
- `/admin` - панель администратора
- `/pending` - заявки на регистрацию
- `/approve <user_id>` - одобрить регистрацию
- `/reject <user_id>` - отклонить регистрацию
- `/game_stats` - статистика игры
- `/posts` - посты без вердиктов

### Процесс регистрации:
1. Игрок использует `/register`
2. Бот спрашивает название и описание страны
3. Бот последовательно спрашивает значения всех 10 аспектов (1-10)
4. Бот спрашивает столицу и население
5. Заявка отправляется администратору
6. Администратор одобряет или отклоняет заявку

## План развития

- **MVP**: Ручная админка
- **v2**: RAG для админа
- **v3**: Автоматические верды
- **v4**: Интерактивная карта